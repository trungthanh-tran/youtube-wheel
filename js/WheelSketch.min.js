function WheelSketch(_p5){const radius=203,diameter=406,itemsPerScreen=7,height_str=58,counterInitial=0,centerX=10,hasNonprintableChars=string=>/[^\x00-\x7F\u0410-\u044FЁё]/.test(string),startAnimationHandler=function(startAnimation){startAnimation()};let data=[],messages=[],messageDisplayDuration=1e3,fallingSpeed=1,wheelTextSize=23,lastKeyPressTime=0,data_list=[],counter,counterDelta=0,counterMax,circleTop,circleCenterY,animationsMap=new Map,selectedKey,isCounterAnimation=!1,counterPrevTickValue=0,video,scaleFactor,fontRegular,mouseDragEnable=!0,touchYPrev=0,useDefaultFont=!1,currentRound=0;function getTotalRowsForDurationAndSpeed(videoDurationSec=22,speedItemsPerSec=3){return speedItemsPerSec*videoDurationSec}function vect(current,from,to,overflow=!0){const offset=-3,overallDegrees=_p5.map(current+-3,from+-3,to,-90,90,!overflow),v=p5.Vector.fromAngle(_p5.radians(overallDegrees),203);return v}function incrementCounter(delta=1){delta=_p5.deltaTime/100*delta,counterDelta=delta,counter+=delta,_p5.onMoveWheel(delta)}function data_key(data_len,key){return data_len?key>=0&&key<data_len?key:data_key(data_len,key>0?Math.abs(data_len-key):data_len+key):key}function alignToRow(endCallback){const half=29,rest=counter%58;let newValue=counter-rest;rest>29&&(newValue=counter+58-rest),animate(tickCounter,counter,newValue,1e3,(function(){animCounterStop(),endCallback&&endCallback()}),easeOutBack)}function tickCounter(v){isCounterAnimation=!0,counterPrevTickValue||(counterPrevTickValue=counter),counterDelta=v-counterPrevTickValue,counter+=counterDelta,counterPrevTickValue=v}function animCounterStop(){isCounterAnimation=!1,counterDelta=0,counterPrevTickValue=0}function animate(tickHook,startNum,endNum,durationMs,callback,easingEq){easingEq=easingEq||easeOutExpo;const changeInNum=endNum-startNum,startTime=Date.now(),engine=function(){const now=Date.now(),timeSpent=now-startTime,timeNorm=timeSpent/durationMs,completionNorm=easingEq(timeNorm),newNum=startNum+completionNorm*changeInNum;timeSpent>durationMs?(animationsMap.delete(`${startNum},${endNum},${durationMs}`),callback&&callback()):tickHook(newNum)};animationsMap.set(`${startNum},${endNum},${durationMs}`,engine)}_p5.setData=function(_data){_data.length||(_data=[""]),data=_data.map(v=>"object"==typeof v?v:{title:v}),useDefaultFont=hasNonprintableChars(data.map(v=>v.title).join()),counterMax=58*data.length,counter=0,_p5.triggerSelectItem()},_p5.setData=function(_data_list,index=0){data_list=_data_list;let _data=_data_list[index].data;_data.length||(_data=[""]),data=_data.map(v=>"object"==typeof v?v:{title:v}),useDefaultFont=hasNonprintableChars(data.map(v=>v.title).join()),counterMax=58*data.length,counter=0,_p5.triggerSelectItem()},_p5.setVideo=function(videos){video=videos},_p5.onAfterSetup=function(){},_p5.onSelectItem=function(items,selectedKey){},_p5.triggerSelectItem=function(){_p5.onSelectItem(data,selectedKey)},_p5.preload=()=>{fontRegular=_p5.loadFont("./fonts/Oswald-Regular.ttf")},_p5.onStartWheel=durationSec=>{},_p5.onStopWheel=()=>{},_p5.onMoveWheel=delta=>{},_p5.setup=()=>{counterMax=58*data.length;const canvas=_p5.createCanvas(800,500);canvas.parent("canvas"),_p5.textSize(23),_p5.textFont(fontRegular),_p5.textLeading(24),_p5.fill(200),circleTop=(_p5.height-406)/2+_p5.textAscent()/3,circleCenterY=circleTop+203,counter=0,button=document.querySelector("#play-btn"),button.addEventListener("click",(function(event){return loadYoutubeIframe(_p5),overlay=document.querySelector("#overlay-start"),overlay.style.display="none",!1})),_p5.onAfterSetup()},_p5.onNextRound=function(){var canv=document.getElementById("countdown-canvas");if(canv.style.display="none",currentRound+=1,currentRound<data_list.length){var overlay=document.createElement("div");overlay.id="overlay",document.body.appendChild(overlay);var svg=document.createElementNS("http://www.w3.org/2000/svg","svg");svg.id="my-svg",svg.setAttribute("viewBox","-500 -500 1000 1000"),svg.setAttribute("width","100%"),svg.setAttribute("height","100%"),svg.setAttribute("preserveAspectRatio","xMidYMin slice");var svgContent='\n              <defs>\n                  <filter id="goo">\n                      <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur"></feGaussianBlur>\n                      <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 20 -5" result="goo"></feColorMatrix>\n                      <feComposite in="SourceGraphic" in2="goo" operator="atop"></feComposite>\n                  </filter>\n              </defs>\n              <text x="0" y="-30vh" text-anchor="middle" font-size="40" font-family="Overpass Mono, monospace;" fill="white">Ready for the next round</text>\n              <g filter="url(#goo)">\n                  <text x="0" y="10vh">3</text>\n                  <text x="0" y="10vh">2</text>\n                  <text x="0" y="10vh">1</text>\n                  <text x="0" y="10vh">GO</text>\n              </g>\n          ';svg.innerHTML=svgContent,document.body.appendChild(svg),overlay.style.display="flex",setTimeout((function(){overlay.style.display="none",overlay.remove(),svg.remove(),canv.style.opacity="1",_p5.reloadData(currentRound),_p5.playRound()}),4e3)}else{var overlayStart=document.getElementById("overlay-start"),playButton=document.getElementById("play-btn"),leaderboard=document.getElementById("leaderboard");overlayStart.style.display="block",playButton.style.display="none",leaderboard.style.display="block",leaderboard.style.zIndex=99999}},_p5.playRound=()=>{const videoContainer=document.getElementById("filter-shadow");if(!isCounterAnimation){const durationSec=30,totalRows=getTotalRowsForDurationAndSpeed(durationSec,Math.floor(4*Math.random())+2);_p5.onStartWheel(durationSec),player&&(player.loadVideoById(data_list[currentRound].id),player.playVideo());const countdownContainer=document.getElementById("countdown-canvas");countdownContainer.style.display="block";for(let i=30;i>=0;i--){const countdownElement=document.createElement("div");countdownElement.className="n",countdownElement.textContent=i,countdownContainer.appendChild(countdownElement)}array_shuffle(data),_p5.triggerSelectItem(),videoContainer.style.animation=`play-video ${durationSec}s`;const overlaystart=document.querySelector("#overlay-start");overlaystart.style.visibility="hidden",animate(tickCounter,counter,counter+58*totalRows,1e3*durationSec,()=>{videoContainer.style.animation=null,animCounterStop(),_p5.onNextRound(),alignToRow(()=>{_p5.onStopWheel()})},easeInOutSine)}},_p5.reloadData=function(index){let _data=data_list[index].data;_data.length||(_data=[""]),data=_data.map(v=>"object"==typeof v?v:{title:v}),useDefaultFont=hasNonprintableChars(data.map(v=>v.title).join()),counterMax=58*data.length,counter=0,_p5.triggerSelectItem()},_p5.mouseDragEnable=(state=!0)=>{mouseDragEnable=state},_p5.guessIt=()=>{let currentTime=(new Date).getTime();if(currentTime-lastKeyPressTime>=100){let message={key:data[selectedKey].title,timestamp:currentTime,y:Math.random()*_p5.height/2+50};messages.push(message),lastKeyPressTime=currentTime}},_p5.mouseDragged=event=>{if(_p5.mouseX>_p5.width||_p5.mouseX<0||_p5.mouseY>_p5.height||_p5.mouseY<0)return;if(isCounterAnimation)return;if(!mouseDragEnable)return;let delta=4*_p5.movedY;if(void 0===_p5.movedY){let diff=_p5.touches[0].y-touchYPrev;delta=12*(diff<0?-1:0===diff?0:1),touchYPrev=_p5.touches[0].y}return incrementCounter(delta),!1},_p5.draw=()=>{_p5.clear(),useDefaultFont?(_p5.textFont("Georgia"),_p5.textAlign(_p5.LEFT,_p5.BOTTOM)):_p5.textFont(fontRegular);let currentTime=(new Date).getTime(),key,i;for(let i=0;i<messages.length;i++){let message=messages[i],elapsedTime=currentTime-message.timestamp,opacity=_p5.map(elapsedTime,0,1e3,255,0),y=_p5.map(elapsedTime,0,1e3,message.y,message.y+200);_p5.fill(0,255,0,opacity),_p5.textSize(50),_p5.text(message.key,50,y),_p5.textSize(23),elapsedTime>=1e3&&(messages.splice(i,1),i--)}for(animationsMap.forEach(startAnimationHandler),counterDelta>0?counter<counterMax?isCounterAnimation||incrementCounter(3):counter=0:counter<0&&(counter=counterMax),i=-data.length-2;i<8;i++){let{x:x,y:y}=vect(counter+58*i+203,circleTop,circleTop+406,!1);x<10||(_p5.push(),_p5.translate(10,circleCenterY),scaleFactor=_p5.map(x,10,213,1,1.5,!1),x*=2-scaleFactor,y*=2-scaleFactor,_p5.scale(scaleFactor),_p5.fill(255,Math.round(_p5.map(x+10,10,213,0,255,!0))),key=data_key(data.length,i),y<_p5.textAscent()/2&&y>-_p5.textAscent()&&(_p5.fill(212,160,0),key!==selectedKey&&(selectedKey=key,_p5.onSelectItem(data,selectedKey))),_p5.text(data[key].title,x,y,450),_p5.pop())}}}